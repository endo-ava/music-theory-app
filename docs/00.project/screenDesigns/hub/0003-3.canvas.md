# コンポーネント仕様: B. メイン表示エリア (Canvas)

[<< Hub画面設計トップに戻る](../0003.hub.md)

## 1. 役割

メイン表示エリア（Canvas）は、Hub & Layerモデルの視覚的な表現領域であり、ユーザーのすべてのインタラクションを受け付ける中心的なステージです。音楽理論の抽象的な概念を、インタラクティブなグラフィックとして具現化します。

## 2. 責務 (Responsibilities)

Canvasコンポーネントは、以下の責務を担います。

### 2.1. Hubの描画

アプリケーションの現在の「ビュー」設定に基づき、中核となるHubコンポーネントを描画します。

- **五度圏 (Circle of Fifths)**: キー同士の関係性やコード進行を分析するためのHub。
- **クロマチックサークル (Chromatic Circle)**: スケールやコードの内部構造（インターバル）を幾何学的に分析するためのHub。

### 2.2. Layerの描画

コントロールパネルで有効化された各種レイヤーを、現在のHubの上にオーバーレイ描画します。

- **スケールレイヤー**: 構成音のハイライト、モードのブライトネスに応じた色分けなど。
- **コードレイヤー**: ダイアトニックコードの扇状ハイライト、機能和声に基づく色分け、構成音の幾何学図形表示など。
- **関係性レイヤー**: 近親調のハイライト、ドミナントモーションの矢印表示など。

### 2.3. 状態の視覚的フィードバック

ユーザーに現在のアプリケーションの状態を常に明確に伝えます。

- **ベースキー表示**:
  - **内容**: Canvas上部中央に、現在設定されているベースキーを「C Major」のようにテキストで表示します。
  - **更新**: ベースキーが変更されると即座に更新されます。
- **選択要素のハイライト**:
  - **ホバー時**: マウスカーソルが乗っている要素を一時的にハイライトします（例: 明るいアウトライン）。
  - **クリック/選択時**: クリックして選択された要素を、より明確にハイライトします（例: 濃いアウトラインや塗り）。

### 2.4. ユーザーインタラクションの受付

ユーザーからの入力を受け付け、対応するアクションを実行、または関連するStoreの状態を更新します。

| 操作               | 対象要素     | アクション                                                                                                                               |
| :----------------- | :----------- | :--------------------------------------------------------------------------------------------------------------------------------------- |
| **ホバー**         | キー、コード | - 要素を一時的にハイライト<br>- インフォメーションパネルに「選択要素情報」を表示                                                         |
| **クリック**       | キー、コード | - 要素を選択状態にし、ハイライトを維持<br>- インフォメーションパネルに「選択要素情報」を表示                                             |
| **ロングプレス**   | キー         | - そのキーを新しい「ベースキー」として設定<br>- Canvas上部のベースキー表示を更新<br>- インフォメーションパネルの「現在のキー情報」を更新 |
| **領域外クリック** | Canvas背景   | - 現在の選択状態を解除し、ハイライトを消去                                                                                               |
