# Hub画面: 横断的インタラクション仕様

[<< Hub画面設計トップに戻る](../0003.hub.md)

## 1. 役割

このドキュメントでは、単一のコンポーネントに閉じず、複数のコンポーネントにまたがって発生する、アプリケーションの横断的なインタラクションについて定義します。

---

## 2. ベースキーシステム

アプリケーション全体の音楽的な文脈（コンテキスト）を決定する、最も重要なインタラクションです。

- **目的**:
  特定のキーを「世界の中心（トニック）」として設定し、他のすべての音楽的要素を、そのキーとの相対的な関係性（ディグリーネーム等）で表示・分析できるようにします。

- **インタラクションフロー**:

| ユーザー操作 (入力)                                   | システムの反応 (出力/フィードバック)                                                                                                                                                                                                                                                              |
| :---------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 1. Canvas上の任意のキーを**ロングプレス**する。       | - そのキーが新しい「ベースキー」として`currentKeyStore`に保存される。<br>- Canvas上部のベースキー表示が更新される。<br>- インフォメーションパネルの「現在のキー情報」エリアが更新される。<br>- Canvas上の他の全要素の表示が、新しいベースキーからの相対的な関係性に基づいて再計算・再描画される。 |
| 2. Canvas上のキーを通常の**タップ（クリック）**する。 | - ベースキーは変更されない。<br>- タップされた要素の情報が「選択要素情報」としてインフォメーションパネルに表示される。                                                                                                                                                                            |

---

## 3. 画面連携 (ライブラリへのリンク)

ユーザーの「知りたい」という探求心をサポートするため、Hub画面からライブラリ画面へ、コンテキストに応じたシームレスな画面遷移を提供します。

| リンク種別           | 目的 (ユーザーの思考)              | UI上の場所                                                               | 遷移先                                                 |
| :------------------- | :--------------------------------- | :----------------------------------------------------------------------- | :----------------------------------------------------- |
| **概念リンク**       | 「このレイヤー（理論）とは何か？」 | コントロールパネルの各レイヤー項目の横にある情報アイコン `(?)`           | ライブラリ画面の、その**理論の概要**を説明するページ。 |
| **キーワードリンク** | 「この専門用語の意味は何か？」     | インフォメーションパネル内に表示される下線付きの専門用語（例: `平行調`） | ライブラリ画面の、その**用語を解説**する詳細ページ。   |
