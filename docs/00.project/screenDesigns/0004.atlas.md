# 画面仕様詳細: Atlas (Knowledge Atlas)

## 1. 画面概要

- **画面ID**: `SCR-002`
- **画面名**: Atlas (旧 Library)
- **概要**: 音楽理論の各用語を深く、正確に学ぶためのリファレンス（辞書）画面。アニメーションやインタラクティブな図解を豊富に用い、静的なテキスト情報に留まらない直感的な理解を促進することを目的とする。

## 目次

1.  [画面概要]
2.  [コア思想]
    1.  [関係性の可視化]
    2.  [感覚的な探索体験]
    3.  [抽象と具体の往復]
3.  [画面全体像]
    1.  [構成要素]
    2.  [PCとMobileの役割分担]
    3.  [PCレイアウト]
    4.  [Mobileレイアウト]
4.  [情報構造]
    1.  [6つの表示領域(Domain)]
    2.  [Node(ノード)の4つの種類]
    3.  [Node配置の思想]
5.  [Atlas画面仕様]
    1.  [PC版レイアウト(探索特化)]
    2.  [Mobile版レイアウト(参照・検索特化)]
6.  [用語ページ仕様]
    1.  [レイアウト構成]
    2.  [視覚的プレビューの種類]
    3.  [音の再生UI]
    4.  [関連用語の表示]
7.  [アニメーション設計指針]
    1.  [基本方針]
    2.  [応答時間の基準]
    3.  [Domain境界の表現]
    4.  [遷移アニメーション (PC)]
    5.  [パフォーマンス考慮事項]
8.  [将来的な拡張機能]
9.  [補足: 用語の定義]
10. [画面連携]

---

## 2. コア思想

Music Theory Atlasは、従来の音楽理論辞典とは異なり、**「地図」**としての体験を提供する。個別の用語を羅列するのではなく、音楽理論の概念同士がどのように関係し、影響し合っているかを視覚的・聴覚的に体験できる設計とする。

### 2.1 関係性の可視化

音楽理論は本質的に、**概念同士の距離感、相互作用、変換の体系**である。Atlas UIでは、これを以下のように表現する。

| 要素   | 表現方法           | 役割                            |
| :----- | :----------------- | :------------------------------ |
| 用語   | 点(Node)           | 個別の音楽理論概念              |
| 領域   | 地形(Region)       | Scale、Chord、Keyなどのドメイン |
| 関係   | 線・光の軌跡(Edge) | 概念間のつながり                |
| 座標系 | 五度圏・音程構造   | 理論体系の骨格                  |

ユーザーは「並んだ項目」ではなく「広がる地形」として音楽理論を把握できる。

### 2.2 感覚的な探索体験

Atlasは「読む」場ではなく、**「触って音を確かめる」**場である。操作のたびに、音・図形・情報が統合的に返ってくる。

この「触る（操作）→ 見る（視覚化）→ 聴く（音）」のサイクルが、知識の暗記ではなく**直感的理解**を促す。

### 2.3 抽象と具体の往復

音楽理論は、抽象的なパターンと具体的な音の実例を行き来する学問である。Atlas UIでは、ユーザーが以下を自由に移動できる構造を意図的に作る。

| レベル | 例                     | 表示内容                   |
| :----- | :--------------------- | :------------------------- |
| 抽象   | メジャースケールの構造 | W-W-H-W-W-W-H のパターン   |
| ↕️     |                        |                            |
| 具体   | Cメジャースケール      | C-D-E-F-G-A-B-C の音と鍵盤 |
| ↕️     |                        |                            |
| 文脈   | CメジャーキーとIコード | 調性における機能           |

この往復を自然にするため、ScaleやChordの表示設計を特に丁寧に行う。

---

## 3. 画面全体像

### 3.1 構成要素

Atlas画面は、4つの主要要素で構成される。

| 要素                                    | 役割                       | 主な機能                         |
| :-------------------------------------- | :------------------------- | :------------------------------- |
| グローバルヘッダー                      | アプリ全体のナビゲーション | Circle/Atlas/About間の移動       |
| サイドバー (PC)                         | フィルタと検索             | Domain表示切り替え、カテゴリ選択 |
| Atlas Canvas (PC) / Mini Atlas (Mobile) | 地図・ノード・関係の表示   | ズーム、パン、ノード選択、検索   |
| 右パネル (PC) / 詳細画面 (Mobile)       | 選択した用語の詳細         | 説明、音再生、関連項目           |

### 3.2 PCとMobileの役割分担

PCとモバイルでは、その利用シーンと画面サイズに基づき、提供する主要体験を明確に分離する。

| プラットフォーム | 主要体験     | 設計方針                                                                                 |
| :--------------- | :----------- | :--------------------------------------------------------------------------------------- |
| **PC**           | 探索型       | Atlas Canvas中心。広い視野での**関係性把握**と**偶発的な発見**を重視する。               |
| **Mobile**       | 参照・検索型 | **Mini Atlas**と**検索**中心。素早く用語を引ける「高性能な辞書」としての体験を重視する。 |

### 3.3 PCレイアウト

PC版は、広範な探索を可能にするため、コントロール領域、メインキャンバス、詳細情報領域を明確に分離した3カラムレイアウトを基本とする。

```
┌────────────────────────────────────────────────────────────┐
│ グローバルヘッダー                                         │
│ [Logo] [Circle] [Atlas] [About]                            │
├──────────┬─────────────────────────────────┬───────────────┤
│          │                                 │               │
│ サイドバー │         Atlas Canvas            │    右パネル     │
│          │       [インタラクティブ地図]        │  (スライドイン) │
│ [フィルタ] │                                 │               │
│ [検索]   │         ・ズーム/パン対応         │    [用語詳細]   │
│ [カテゴリ] │         ・ノード配置              │    [音再生]     │
│          │         ・関係線表示              │    [関連項目]   │
│          │                                 │               │
├──────────┴─────────────────────────────────┴───────────────┤
│ フッター [閲覧履歴 → 横スクロール]                          │
└────────────────────────────────────────────────────────────┘
```

### 3.4 Mobileレイアウト

Mobile版は、PC版のレイアウトを踏襲しつつ、グローバルヘッダーによるナビゲーション導線を確保する。検索機能を主要なアクセスポイントとして配置する。

```
┌─────────────────────┐
│ グローバルヘッダー  │
│ [Logo] [Nav] [Menu] │
├─────────────────────┤
│ 検索バー [🔍]       │
├─────────────────────┤
│                     │
│ Mini Atlas / 検索ビュー│
│ (タッチ対応)        │
│                     │
│ ・ピンチズーム      │
│ ・パン              │
│ ・ノードタップ      │
│                     │
└─────────────────────┘

↓ ノードタップ時 または 検索結果選択時

┌─────────────────────┐
│ [← 戻る]           │
├─────────────────────┤
│                     │
│ 用語詳細ページ      │
│ (全画面)            │
│                     │
│ ・タイトル          │
│ ・視覚的プレビュー  │
│ ・説明              │
│ ・音再生            │
│ ・関連項目          │
│                     │
└─────────────────────┘
```

---

## 4\. 情報構造

### 4.1 6つの表示領域(Domain)

Atlasの情報は、以下の6つの領域に分けて配置される。これらはUI上の区画であり、ユーザーが音楽理論を探索しやすいように整理されている。

情報は「Pitch」を基点に、「Interval」を経て「Scale」「Chord」のパターンへと分岐し、最終的に「Key」という文脈に統合される流れを基本とする。

| Domain                | 説明               | 配置位置     | 主な要素                             |
| :-------------------- | :----------------- | :----------- | :----------------------------------- |
| ① Pitch Domain        | 音名・ピッチクラス | 中心部       | 12のピッチクラス、五度圏との同期     |
| ② Interval Domain     | 音程               | 中心やや外側 | セミトーン距離、放射状/アーク表示    |
| ③ Scale Domain        | スケール・パターン | 中間左側     | メジャー系、教会旋法、ペンタトニック |
| ④ ChordPattern Domain | コード構造         | 中間右側     | Triad、7th、9th、Sus、Altered        |
| ⑤ Chord Domain        | 具体的な和音       | 外周右側     | Cmaj7、G7、Eb9など                   |
| ⑥ Key Domain          | 調性・五度圏       | 右側         | 24のメジャー/マイナーキー            |

### 4.2 Node(ノード)の4つの種類

Atlasに登場するすべての要素は\*\*「Node」\*\*としてCanvas上に配置される。
（注：この分類はあくまで設計上のガイドラインであり、厳密なものではない。例えば「Function」のように複数の領域にまたがる概念も存在する）

| 種類               | 説明             | 配置       | 音の有無         | 例                               |
| :----------------- | :--------------- | :--------- | :--------------- | :------------------------------- |
| ① 基底概念         | 理論の根本概念   | 中心部     | なし/例のみ      | Pitch, Interval, Degree          |
| ② 抽象構造         | パターン・設計図 | 中間リング | あり(構造確認用) | ScalePattern, ChordPattern       |
| ③ 具体インスタンス | 実際の音         | 外周       | あり(メイン)     | Cmaj7, G7, C Major Scale         |
| ④ 文脈付き概念     | 調性・機能       | 右側領域   | あり(文脈込み)   | C Major Key, Imaj7, V7, Function |

#### 4.2.1 基底概念(Foundation Concepts)

- **定義:** 音楽理論の根本を成す抽象的な概念。
- **例:** Pitch, Pitch Class, Interval, Degree, Enharmonic
- **UI上の特徴:** Atlas中心部の「理論コア領域」に配置。多くの関連線が伸びるハブとして機能する。

#### 4.2.2 抽象構造(Patterns / Structures)

- **定義:** スケールやコードの「設計図」としての概念。
- **例:** ScalePattern (Major, Dorian...), ChordPattern (Maj7, m7...)
- **UI上の特徴:** 基底概念の一段階外側のリングに配置。ノードアイコンは構造図形(音程の並び)。

#### 4.2.3 具体インスタンス(Concrete Instances)

- **定義:** 実際に鳴らせるスケールやコード。
- **例:** C Major Scale, D Dorian Scale, Cmaj7, G7(b9)
- **UI上の特徴:** Canvas外周の広い領域に配置。**初期状態では非表示**（情報過多を防ぐため）。

#### 4.2.4 文脈付き概念(Contextual Concepts)

- **定義:** 調性や機能など、文脈情報を含む概念。
- **例:** C Major Key, Imaj7(機能), V7(機能), Modulation
- **UI上の特徴:** Atlas右側の「Key Domain」に寄せて配置。五度圏との関連性が強い。

### 4.3 Node配置の思想

Atlasは**中心から外側へ向かうほど抽象から具体へ移行**する構造になっている。

| レイヤー       | 内容             | 役割             | 距離感   |
| :------------- | :--------------- | :--------------- | :------- |
| **中心**       | 基底概念         | 理論の出発点     | 0-20%    |
| **中間リング** | 抽象構造         | 構造の種類を俯瞰 | 20-50%   |
| **外周**       | 具体インスタンス | 実際に鳴らせる音 | 50-80%   |
| **右側**       | Key/Function領域 | 調性と機能和声   | 特殊配置 |

---

## 5\. Library画面仕様

### 5.1 PC版レイアウト(探索特化)

#### 5.1.1 サイドバー

**役割:**

- 表示領域(Domain)のON/OFF切り替え
- レイヤー表示切り替え(例: 主音のみ表示、ダイアトニック表示)
- カテゴリフィルタ

**構成 (例):**

- **カテゴリ**
  - [☑] Elements
  - [☑] Structures
  - [☐] Contexts
- **スケール**
  - [☑] メジャー系
  - [☐] モード系
  - ...
- **コード**
  - [☐] Triad
  - [☑] 7th
  - ...
- **具体インスタンス**
  - [☐] すべて表示
  - [☑] 主要のみ

#### 5.1.2 Atlas Canvas(地図)

Canvasは、Library画面の中心的な要素である。

**主な機能:**

- **ズーム:**
  - Level 1: 全体地図 (すべてのDomainを俯瞰)
  - Level 2: 領域拡大 (Scale Domainなどにフォーカス)
  - Level 3: ノード詳細 (個別用語を中心に)
- **操作:**
  - ドラッグ: パン移動
  - ホイール: ズーム
  - ホバー: ミニラベル表示
  - クリック: 右パネル表示
- **描画レイヤー:**
  - Layer 1: 背景地形 (グラデーション)
  - Layer 2: Domain境界 (柔らかい陰影)
  - Layer 3: 関係線 (Edge)
  - Layer 4: ノード (発光する粒子)
  - Layer 5: ラベル (ホバー時のみ)

**ズームレベル詳細:**

| レベル  | 視野範囲   | 表示内容                           | ノード密度             |
| :------ | :--------- | :--------------------------------- | :--------------------- |
| Level 1 | 全体       | すべてのDomain境界、主要ノードのみ | 低(20-30個)            |
| Level 2 | Domain単位 | 選択Domainの全ノード               | 中(50-100個)           |
| Level 3 | ノード周辺 | 選択ノードと直接関連               | 高(選択ノードを中心に) |

**状態管理:**

| 状態       | Canvas   | 右パネル | 備考           |
| :--------- | :------- | :------- | :------------- |
| 閉じている | フル幅   | 非表示   | 通常の探索状態 |
| 開いている | 60-70%幅 | 表示     | 用語詳細閲覧中 |

#### 5.1.3 右パネル(用語詳細)

- **表示タイミング:** ノードクリック時に右からスライドイン (0.25秒, ease-out)
- **幅:** 画面の30-40%
- **内容:** 詳細は[6. 用語ページ仕様]参照

#### 5.1.4 フッター(閲覧履歴・パンくず)

地図上を移動している間、最近閲覧した用語が横スクロールで表示される。

```
┌──────────────────────────────────────────────┐
│ 最近見た: [★ Cmaj7] [★ Dorian] [★ V7] → │
└──────────────────────────────────────────────┘
```

### 5.2 Mobile版レイアウト(参照・検索特化)

PCの「探索」体験をそのまま持ち込むのではなく、「参照」ファーストで設計する。
**Mini Atlas**（PC版Canvasの簡易版、または特定領域にフォーカスしたもの）と、強力な**検索機能**をUIの中心に据える。

#### 5.2.1 基本構造

レイアウト図は[3.4 Mobileレイアウト]を参照。
検索バーを常にアクセス可能な位置に配置し、メインビュー（Mini Atlas / 検索結果リスト）からシームレスに詳細ページへ遷移できるようにする。

#### 5.2.2 タッチ操作の詳細

| ジェスチャー      | 動作                  | フィードバック         |
| :---------------- | :-------------------- | :--------------------- |
| タップ            | ノード選択 / 項目選択 | 軽い振動、ノード点滅   |
| ロングタップ      | クイックプレビュー    | ポップアップ表示       |
| ピンチイン/アウト | ズーム                | スムーズなスケール変化 |
| ドラッグ          | パン移動              | 慣性スクロール         |

#### 5.2.3 Mini Atlas / 参照ビューの最適化

- **情報密度の調整:**
  - ズームレベル 1 (全体表示): Domain境界のみ、主要ノード10-15個、ラベル非表示
  - ズームレベル 2 (中間): 選択Domain内のノード、ラベルは大きめフォント
  - ズームレベル 3 (詳細): すべてのノード表示、ラベル常時表示
- **検索ビュー:** 検索時はAtlasを非表示にし、検索結果リストを優先するオプションも設ける。

| 要素       | PCサイズ   | Mobileサイズ | 理由                 |
| :--------- | :--------- | :----------- | :------------------- |
| ノード     | 16-24px    | 32-44px      | タッチターゲット確保 |
| ラベル     | 12px       | 14-16px      | 可読性向上           |
| タップ領域 | ノード同等 | +16px余白    | 誤タップ防止         |

#### 5.2.4 詳細ページへの遷移

ノードタップ、または検索結果タップで、詳細ページが下からスライドアップ、または横からスライドインして全画面表示される。

```
Mini Atlas / 検索リスト (タップ)
    ↓
詳細ページがスライドアップ (0.3秒)
    ↓
全画面表示
```

#### 5.2.5 検索機能との統合

検索入力時は、Mini Atlasを暗くするか、検索結果リストで上書きする。

```
┌─────────────────────┐
│ [🔍] Lydian____     │ ← 検索入力
├─────────────────────┤
│ 検索結果:           │
│ • Lydian Mode       │
│ • Lydian b7         │
│ • Lydian Dominant   │
├─────────────────────┤
│   (Mini Atlasは      │
│ 　 検索結果の背景     │
│    または非表示)      │
└─────────────────────┘
```

---

## 6\. 用語ページ仕様

PCでは右パネル、Mobileでは全画面で表示される。内容は共通とする。

### 6.1 レイアウト構成

**表示順序(固定):**

1.  タイトル(用語名)
2.  カテゴリタグ
3.  視覚的プレビュー (最重要)
4.  短い要約(1〜2行)
5.  詳細説明(複数段落)
6.  音の再生UI
7.  関連用語・関連領域へのリンク

**実際の表示例 (Cmaj7):**

```
┌─────────────────────────────┐
│ Cmaj7                       │ ← 1. タイトル
│ [Scale] [Chord] [Diatonic]  │ ← 2. タグ
├─────────────────────────────┤
│ [🎹 鍵盤図] [📊 構造図] [⭕ 五度圏] │ ← 3. プレビュー
├─────────────────────────────┤
│ Cを根音とするメジャーセブンスコード。 │ ← 4. 要約
├─────────────────────────────┤
│ 構成音: C-E-G-B             │
│ 音程構造: 根音-長3度-完全5度-長7度 │ ← 5. 詳細説明
│ 機能: Imaj7 (トニック) ...        │
├─────────────────────────────┤
│ [▶ 再生] [音色: Piano ▼]       │ ← 6. 音再生
│ [単音] [ブロック] [アルペジオ]    │
├─────────────────────────────┤
│ 関連:                       │
│ → G7 (V7へ)                 │ ← 7. 関連項目
│ → C Major Scale             │
└─────────────────────────────┘
```

### 6.2 視覚的プレビューの種類

用語のタイプによって表示内容を切り替える。

| 用語タイプ               | 主なプレビュー要素                                      |
| :----------------------- | :------------------------------------------------------ |
| **Scale / ScalePattern** | 鍵盤図, 音程構造 (W-W-H...), 五度圏での位置             |
| **Chord / ChordPattern** | 鍵盤図, 構成音(R, M3, P5, M7), 3Dスタック構造, 機能タグ |
| **Key**                  | 五度圏での位置, ダイアトニックコード一覧 (I〜VII)       |
| **Interval**             | 距離(セミトーン数), ピアノロールでの視覚的距離          |

### 6.3 音の再生UI

```
┌────────────────────────────────┐
│ 🔊 音を聴く                     │
├────────────────────────────────┤
│ [▶ 再生]   [音色: Piano ▼]      │
├────────────────────────────────┤
│ 再生方法: ( ) 単音 (●) ブロック ( ) アルペジオ │
└────────────────────────────────┘
```

- **再生方法:** 単音, ブロックコード, アルペジオ, (Scaleの場合) 上昇/下降
- **音色:** Sine Wave (純音), Piano (標準), Electric Piano

### 6.4 関連用語の表示

各用語タイプに応じた関連情報を、クリック（タップ）可能なカード形式で表示する。

| 元の用語タイプ | 関連項目の例                                   |
| :------------- | :--------------------------------------------- |
| Scale          | 派生モード、平行調                             |
| Chord          | 同構造の別ルート、代理コード、V7へ進む先       |
| Key            | ダイアトニックコード、スケール、平行調、同主調 |
| Interval       | 該当音程を含むコード                           |

---

## 7\. アニメーション設計指針

アニメーションは装飾ではなく\*\*「意味」\*\*を持つために用いる。

### 7.1 基本方針

1.  **意味の可視化:** アニメーションは情報の流れや関係性を示すために使う。
    (例: ノードクリック時、Atlas上のノードから右パネルへ光が流れるエフェクト)
    ```
    Atlas Canvas         右パネル
        [●] ─────光る線─────→ [詳細]
         ↑                     ↑
       クリック                 表示
         │
       [意味: この情報がパネルに送られている]
    ```
2.  **素早い応答:** 操作には0.1〜0.15秒以内に何らかの視覚的フィードバックを返す。
3.  **LOD(Level of Detail):** ズームレベルに応じて、表示する情報量（ノード、ラベル、線）を動的に変更する。

### 7.2 応答時間の基準

| 操作       | 応答時間    | Easing      | 理由                 |
| :--------- | :---------- | :---------- | :------------------- |
| ホバー     | 0.1〜0.15秒 | ease-out    | 即座のフィードバック |
| クリック   | 0.25秒前後  | ease-out    | 明確な状態変化       |
| ページ遷移 | 0.3秒       | ease-in-out | スムーズな切り替え   |

### 7.3 Domain境界の表現

Domainごとの「地形」は、柔らかいグラデーションと陰影で表現する。

| Domain       | ベース色相 (例) | 意味           |
| :----------- | :-------------- | :------------- |
| Pitch        | 青(200°)        | 基礎・冷静     |
| Interval     | 緑(120°)        | つながり・成長 |
| Scale        | 黄緑(80°)       | 展開・広がり   |
| ChordPattern | オレンジ(30°)   | 構造・温かみ   |
| Chord        | 赤(0°)          | 具体・情熱     |
| Key          | 紫(280°)        | 調性・統合     |

### 7.4 遷移アニメーション (PC)

#### 7.4.1 検索→用語ジャンプ

1.  検索候補を選択
2.  カメラが該当ノードへ滑らかに移動 (0.6秒, ease-in-out)
3.  到着時、ノードが3回点滅
4.  右パネルが自動スライドイン

#### 7.4.2 関連リンク→移動

1.  関連リンクをクリック
2.  現在のノードから対象ノードへ光の軌跡(Edge)が描画される
3.  カメラが軌跡を追いかけるように移動 (0.5秒)
4.  対象ノードに到着し、詳細情報がクロスフェードで更新される

### 7.5 パフォーマンス考慮事項

- アニメーションは `transform` と `opacity` を中心に使い、GPU加速を前提とする。
- モバイルデバイスや表示ノード数が多い場合は、パーティクルや波紋エフェクトを簡略化、またはOFFにする。

---

## 8\. 将来的な拡張機能

- **学習パス機能 (優先度: 高):**
  初学者向けに推奨される学習順序をAtlas上にガイドラインとして表示する。
- **比較モード (優先度: 中):**
  2つのノード(例: C MajorとD Dorian)を選択し、構造の違いを並べて比較する。
- **学習グラフ機能 (優先度: 高):**
  ユーザーがたどった閲覧履歴を、線で結んだミニマップとして可視化する。

---

## 9\. 補足: 用語の定義

| 用語   | 定義                                            |
| :----- | :---------------------------------------------- |
| Node   | Atlas上の個別の音楽理論概念を表す点             |
| Domain | 関連する概念のグループ(Pitch, Scale, Chord等)   |
| Edge   | ノード間の関係を示す線                          |
| Canvas | ノードと関係を表示する地図領域                  |
| LOD    | Level of Detail: ズームレベルに応じた表示詳細度 |
| Easing | アニメーションの加減速カーブ                    |

---

## 10\. 画面連携

- ハブ画面の「概念リンク」および「キーワードリンク」から、この画面の該当ページへ直接遷移できる。
- ユーザーは本画面で知識を補完した後、グローバルナビゲーションを用いて再びハブ画面に戻り、学習を継続できる。

---

**以上**
